!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).Shai=r()}(this,(function(){"use strict";function t(r){var e=Array.isArray(r)?[]:{};for(var n in r)if(r.hasOwnProperty(n)){var o=r[n];e[n]="object"==typeof o?t(o):o}return e}return function(){function r(){this.__funcs=[],this.__data=[],this.__propKey="setting",this.use=this.use.bind(this),this.gen=this.gen.bind(this)}return r.prototype.setv=function(t,r){var e=t.length-1;t.reduce((function(t,n,o){return o===e&&(t[n]=r),t[n]}),this.__data)},r.prototype.addChild=function(r,e,n,o){var a=o.at||0;n--;for(var i=function(i,f){var u=r[i];o.renew&&a===n&&(u=Object.assign?Object.assign(u,o.renew):function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t}(u,o.renew)),o.remove&&a===n&&o.remove.forEach((function(t){u.hasOwnProperty(t)&&delete u[t]})),n>0&&!u.hasOwnProperty(e)&&(u[e]=t(r),s.addChild(u[e],e,n,o))},s=this,f=0,u=r.length;f<u;f++)i(f);return r},r.prototype.transform=function(r,e){if(e){var n=function(t){var r=1;return"number"==typeof t?r=t:Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1]&&(r=~~(Math.random()*(t[1]-t[0])+t[0])),r},o="number"==typeof e||Array.isArray(e)&&"number"==typeof e[0]&&"number"==typeof e[1]?n(e):"object"==typeof e&&e.length?n(e.length):1,a=new Array(o);delete r[this.__propKey];for(var i=0;i<o;i++)a[i]=t(r);if("object"!=typeof e||"number"==typeof e||Array.isArray(e))r=a;else{var s="number"==typeof e.level?e.level:1,f=e.key||"children";if(e.at&&e.at>=s)throw new Error('setting "at" out of range!');f&&(r[f]=this.addChild(a,f,s,e))}}return r},r.prototype.parseBlock=function(){var t=this,r=function(e,n){var o,a;!Array.isArray(e)&&e.hasOwnProperty(t.__propKey)&&(a=(o=e)[t.__propKey],e=o=t.transform(o,a),n?t.setv(n,e):t.setv([],t.__data=e));var i=function(t){if(e.hasOwnProperty(t)){var o=e[t];Array.isArray(o)&&"▒"!==o[0]?o.forEach((function(e,o){return r(e,n?n.concat([t,o]):[t,o])})):Array.isArray(o)||"object"!=typeof o||r(o,n?n.concat([t]):[t])}};for(var s in e)i(s)};r(this.__data)},r.prototype.setValues=function(t,r){var e=this;if(Array.isArray(t))if("▒"===t[0]){var n=r||[],o=this.__funcs[t[1]].concat();try{this.setv(n,o.length>0?o[0].apply(o,o[1]):t)}catch(r){throw new Error((n.length>0?n.join("."):t)+": error, "+r)}}else t.forEach((function(t,n){return e.setValues(t,r?r.concat([n]):[n])}));else"object"==typeof t&&Object.keys(t).forEach((function(n){return e.setValues(t[n],r?r.concat([n]):[n])}))},r.prototype.use=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return["▒",this.__funcs.push([t,r])-1]},r.prototype.gen=function(t,r){if("object"==typeof t)return r&&(this.__propKey=r),this.__data=t,this.parseBlock(),this.setValues(this.__data),this.__data},r}()}));
//# sourceMappingURL=shai.js.map
